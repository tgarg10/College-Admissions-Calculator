#l = [459999, 373581, 349777, 337893, 334915, 328504, 315122, 257451, 229381, 229169, 226559, 191606, 186496, 185027, 123173, 88258, 87383, 70175, 67352, 56267, 55851, 51934, 42366, 15312, 8408, 424264, 373580, 355533, 236103, 226386, 210444, 192392, 114896, 70226, 50628, 21366, 17220, 8519, 8437, 490862, 404875, 333705, 257564, 212932, 104114, 68551, 56438, 55958, 50789]
t = {'217299', '217161', '12452', '12408', '146386', '38068', '83221', '67906', '52357', '51627', '50456', '50303', '47417', '52330', '38068', '44936', '52357', '13602', '10467', '10571', '11858', '458777', '397394', '225623', '222836',}
s = {'212932', '104114', '8515', '233289', '87493', '460962', '46619', '8871', '459416', '53440', '10151', '10147', '21366', '257564', '193638', '57532', '54080', '30122', '17857', '65808', '18238', '45976', '26301', '17871', '167581', '8568', '459416', '10667', '8514', '53440', '18098', '10674', '10147', '88258', '55851', '42366', '210444', '192392', '70226', '333705', '50789', '50296', '167593', '66888', '55826', '54451', '54446', '21257', '337461', '193638', '79305', '67384', '30122', '21816', '21195', '8627', '66365', '65559', '57381', '225574', '65776', '21347', '9942', '8521', '166307', '56869', '55929', '56250', '55967', '47945', '26896', '7929', '56467', '17518', '9017', '61425', '227004', '9104', '9041', '21907', '21231', '373581', '226559', '42366', '424264', '226386', '8437', '333705', '12504', '11431', '8426', '192103', '67358', '66888', '66631', '55826', '8574', '8540', '8627', '8293', '143497', '65559', '39229', '21274', '8516', '8509', '460422', '227247', '225574', '64900', '64884', '21347', '67365', '56869', '9606', '108232', '8528', '61425', '18410', '9046', '317094', '21217', '10672', '9104', '8522', '24788', '22352', '21924', '21907', '21231', '226559', '185027', '123173', '68551', '12504', '8535', '8426', '8425', '192103', '55783', '8574', '8540', '43968', '143497', '39229', '8516', '460422', '227247', '64900', '64884', '67365', '108232', '52234', '17200', '56145', '17856', '9046', '21217', '10672', '8522', '43400', '26303', '22352', '21924', '17800', '257451', '185027', '123173', '68551', '8535', '8425', '327810', '55783', '50997', '43968', '216912', '65829', '8524', '8539', '52234', '19169', '17200', '8561', '56145', '17856', '10646', '8592', '370332', '8533', '43400', '26303', '17800', '8410', '257451', '229381', '15312', '8408', '373580', '236103', '327810', '50997', '17832', '208675', '174173', '21186', '9255', '216912', '69229', '65829', '17199', '9409', '8524', '207909', '51550', '8539', '56783', '21196', '327587', '20847', '19169', '8561', '10646', '8592', '8534', '370332', '18493', '8533', '19204', '21442', '8410', '315122', '229381', '186496', '70175', '15312', '8408', '373580', '355533', '236103', '114896', '50628', '209063', '157379', '59863', '17832', '7821', '208675', '174173', '54128', '21186', '9255', '69229', '66886', '17199', '11589', '9409', '207909', '67617', '55938', '51550', '8546', '56783', '21196', '8513', '327587', '55746', '20847', '19080', '8534', '59673', '18493', '227375', '19204', '9100', '21442', '8559', '10675', '315122', '229169', '186496', '70175', '355533', '114896', '50628', '8519', '488060', '482241', '209063', '157379', '59863', '21255', '8571', '7821', '102164', '56706', '54128', '17817', '66886', '66189', '52988', '11589', '67617', '55938', '8546', '67489', '43405', '8513', '82351', '55746', '21199', '19080', '10671', '401525', '69784', '59673', '55858', '17306', '227375', '9100', '9053', '8944', '21457', '8559', '8531', '181249', '10675', '229169', '191606', '67352', '8519', '11436', '488060', '482241', '472719', '66318', '53673', '22194', '21255', '8571', '454099', '260160', '102164', '56706', '56553', '17817', '66189', '52988', '51206', '10441', '408545', '67489', '43405', '26283', '21370', '82351', '21199', '12709', '8537', '10671', '401525', '69784', '55858', '17306', '8541', '9053', '8944', '21457', '8531', '181249', '9037', '459999', '328504', '191606', '67352', '56267', '51934', '17220', '11436', '472719', '448197', '203894', '66910', '66318', '53673', '22194', '454099', '260160', '56553', '51206', '50331', '44809', '21229', '21220', '17197', '10441', '17814', '8632', '8599', '408545', '72793', '26283', '21370', '40837', '22042', '12709', '8537', '8541', '17830', '212940', '9037', '459999', '337893', '328504', '87383', '56267', '51934', '17220', '448197', '203894', '69922', '66910', '51679', '386717', '239732', '56018', '50331', '44809', '21229', '21220', '17197', '124302', '56251', '39327', '17814', '8632', '8599', '72793', '45737', '8573', '338068', '40837', '22042', '10649', '72109', '28630', '17571', '43403', '21429', '320823', '17830', '243561', '212940', '56172', '21898', '21194'}
t = tuple(t)
s = tuple(s)
t = t+s
import requests,csv
sports_list = []
w = open('profiles_harv.csv','a',newline='')
c = csv.writer(w)
#f = requests.get('https://www.admitsee.com/profile-detail/373581','html.parser')
for i in range(len(t)):
    try:
        idd = t[i]
        f = requests.get('https://www.admitsee.com/profile-detail/'+idd,'html.parser')
        a = f.text
        sat = a.partition('<span class="p_label">Converted SAT Score</span><span class="lockedfoo theconvertedsat">')[2][:4]
        gpa = a.partition('<div class="t_score thegpa">')[2][:4] 
        act = a.partition('<div class="t_score theact">')[2][:2]
        course = a.partition('<div class="user_major">')[2]
        course = str(course[:course.find('</span>')]).replace('<span itemprop=""title"">', '').replace('""','')
        gender = a.partition('<div class="hidethese"><span class="p_label">Gender</span><span>')[2]
        gender = gender[:gender.find('</span>')]
        ethnicity = a.partition('<div class="hidethese"><span class="p_label">Ethnicity</span><span>')[2]
        ethnicity = ethnicity[:ethnicity.find('</span>')]
        class_year =  a.partition('<span class="p_label">Class of</span><span>')[2][:4]
        firstgen = a.partition('<span class="p_label">First Gen College Student</span><span>')[2]
        firstgen = firstgen[:firstgen.find('</span>')]
        admission = a.partition('<span class="p_label">Admission</span><span>')[2]
        admission = admission[:admission.find('</span>')]
        sports = a.partition('<h2>Sports</h2>\n</div>\n<div class="p_panel_content">\n<span class="p_label">Sports</span><span>')[2]
        sports_list += [sports[:sports.find('</span>')]]
        #o = [idd,sat,gpa,act,gender,ethnicity,class_year,firstgen,]
        #print(o)
        c.writerow([idd,sat,gpa,act,course,gender,ethnicity,class_year,firstgen,admission])
        w.flush()
        #print(idd,sat,gpa,act,gender,ethnicity,class_year,firstgen,sep=',')
    except Exception as e:
        print(e)
w.close()
print(sports_list)     


